{% extends 'estate/base.html' %}

{% load static%}

{% block extra_css %}
  <link rel="stylesheet" href="{% static 'estate/css/user_profile.css' %}">
{% endblock %}

{% block content %}

<div class="dashboard-header">
  <div class="container">
    <h2>Your Profile Dashboard</h2>
  </div>
</div>

<div class="container pb-5">
  <!-- News Card -->
  <div class="card news-card mb-4">
    <div class="card-body">
      <h5>Today's Real Estate News</h5>
      <p class="card-text">
        <strong>{{ headline }}</strong>
      </p>
      <a href="{% url 'articles' %}" class="btn">Read Full Article</a>
    </div>
  </div>

  <!-- Profile Card -->
  <div class="card profile-card mb-4">
    <div class="card-body d-flex flex-column flex-md-row align-items-center">
      {% if user.profile.image %}
        <img src="{{ user.profile.image.url }}" class="rounded-circle profile-avatar me-md-4 mb-3 mb-md-0" alt="Profile">
      {% else %}
        <div class="rounded-circle profile-avatar-placeholder text-white d-flex align-items-center justify-content-center me-md-4 mb-3 mb-md-0">
          {{ user.username|first|upper }}
        </div>
      {% endif %}

      <div class="profile-info flex-grow-1">
        <h5>
          {% if user.first_name and user.last_name %}
            {{ user.first_name }} {{ user.last_name }}
          {% else %}
            {{ user.username }}
          {% endif %}
        </h5>
        {% if user.first_name and user.last_name %}
          <div class="username">@{{ user.username }}</div>
        {% endif %}
        <p class="email">{{ user.email }}</p>
        <div class="d-flex flex-wrap gap-2">
          <a href="{% url 'update-profile' user.id %}" class="btn btn-primary-custom">Update Profile</a>
          <a href="{% url 'change-password' %}" class="btn btn-outline-danger-custom">Change Password</a>
        </div>
      </div>
    </div>
  </div>

  <!-- Dashboard Cards -->
  <div class="row g-4">
    <div class="col-md-6">
      <div class="card dashboard-card">
        <span class="card-icon">üèòÔ∏è</span>
        <div class="card-body d-flex flex-column">
          <h5>My Property Listings</h5>
          <p class="card-text flex-grow-1">View, edit, or add new properties to showcase your listings.</p>
          <div class="d-flex flex-wrap gap-2 mt-auto">
            <a href="{% url 'my-listings' %}" class="btn btn-primary-custom">Manage Listings</a>
            <div class="dropdown">
              <button class="btn btn-success-custom dropdown-toggle" type="button" data-bs-toggle="dropdown">
                Add New Property
              </button>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="{% url 'sell-property' %}">List for Sale</a></li>
                <li><a class="dropdown-item" href="{% url 'lease-property' %}">List for Lease</a></li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-6">
      <div class="card dashboard-card">
        <span class="card-icon">‚ù§Ô∏è</span>
        <div class="card-body d-flex flex-column">
          <h5>My Saved Properties</h5>
          <p class="card-text flex-grow-1">Track properties you favorited and revisit them anytime.</p>
          <a href="{% url 'wishlist' %}" class="btn btn-primary-custom mt-auto">View Wishlist</a>
        </div>
      </div>
    </div>

    <div class="col-md-6">
      <div class="card dashboard-card">
        <span class="card-icon">üìã</span>
        <div class="card-body d-flex flex-column">
          <h5>
            My Applications
            <span class="coming-soon-badge">Coming Soon</span>
          </h5>
          <p class="card-text flex-grow-1">Follow up on rental or purchase applications you submitted.</p>
          <a href="#" class="btn btn-outline-custom mt-auto" style="opacity: 0.6; cursor: not-allowed;">Review Applications</a>
        </div>
      </div>
    </div>

    <div class="col-md-6">
      <div class="card dashboard-card">
        <span class="card-icon">‚öôÔ∏è</span>
        <div class="card-body d-flex flex-column">
          <h5>Account & Privacy</h5>
          <p class="card-text flex-grow-1">Adjust your personal details, visibility, and privacy settings.</p>
          <a href="{% url 'settings' %}" class="btn btn-outline-custom mt-auto">Manage Account</a>
        </div>
      </div>
    </div>
  </div>
</div>

{% endblock %}