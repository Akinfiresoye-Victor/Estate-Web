{% extends 'estate/base.html' %}
{% load static %}
{% load property_extras %}

{% block extra_css %}
  <link rel="stylesheet" href="{% static 'estate/css/view_prop_s.css' %}">
{% endblock %}

{% block content %}

<div class="detail-wrapper">
    <div class="detail-container">

        <!-- Back Button -->
        <div class="back-button-section">
            <a href="{% url 'buy-property' %}" class="btn-back">
                <i class="fas fa-arrow-left me-2"></i>
                Back to Sales Listings
            </a>
        </div>

        <!-- Property Card -->
        <div class="property-card">

            <!-- Property Header -->
            <div class="property-header">
                <div class="header-badge">
                    <i class="fas fa-tag me-1"></i>
                    For Sale
                </div>
                <h1 class="property-title">{{ property.summary|default:"Beautiful Property for Sale" }}</h1>
                <div class="property-location">
                    <div class="location-item">
                        <i class="fas fa-map-marker-alt"></i>
                        <span>{{ property.location|default:"Unknown Location" }}</span>
                    </div>
                    <div class="location-item">
                        <i class="fas fa-globe"></i>
                        <span>{{ property.state|default:"Unspecified" }}</span>
                    </div>
                </div>
            </div>

            <!-- Main Image -->
            <div class="main-image-section">
                {% if property.base_image %}
                    <img src="{{ property.base_image.url }}"
                         onerror="this.onerror=null;this.src='https://placehold.co/1200x600/e7f3ff/007bff?text=No+Image+Available';"
                         class="main-image"
                         alt="Main Property Image">
                {% else %}
                    <img src="https://placehold.co/1200x600/e7f3ff/007bff?text=No+Base+Image"
                         class="main-image"
                         alt="Placeholder Image">
                {% endif %}
            </div>

            <!-- Gallery Images -->
            {% with property|get_images as gallery_images %}
                {% if gallery_images %}
                <div class="gallery-section">
                    <h3 class="section-title">
                        <i class="fas fa-images me-2"></i>
                        Property Gallery
                    </h3>
                    <div class="gallery-grid">
                        {% for img in gallery_images %}
                            <div class="gallery-item">
                                <img src="{{ img.url }}"
                                     onerror="this.onerror=null;this.src='https://placehold.co/400x300/e7f3ff/007bff?text=No+Image';"
                                     alt="Property Image {{ forloop.counter }}">
                            </div>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}
            {% endwith %}

            <!-- Price and Description -->
            <div class="price-section">
                <div class="price-box">
                    <span class="price-label">Sale Price</span>
                    <span class="price-amount">â‚¦{{ property.price|default:"N/A" }}</span>
                </div>
            </div>

            <div class="description-section">
                <h3 class="section-title">
                    <i class="fas fa-align-left me-2"></i>
                    Description
                </h3>
                <p class="description-text">{{ property.property_description|default:"No detailed description available for this property." }}</p>
            </div>

            <!-- Features and Agent Info -->
            <div class="info-grid">
                <!-- Features -->
                <div class="info-card features-card">
                    <h4 class="info-card-title">
                        <i class="fas fa-star me-2"></i>
                        Key Features
                    </h4>
                    <ul class="feature-list">
                        <li class="feature-item">
                            <div class="feature-icon">
                                <i class="fas fa-bed"></i>
                            </div>
                            <div class="feature-content">
                                <span class="feature-label">Bedrooms</span>
                                <span class="feature-value">{{ property.bedrooms|default:"N/A" }}</span>
                            </div>
                        </li>
                        <li class="feature-item">
                            <div class="feature-icon">
                                <i class="fas fa-bath"></i>
                            </div>
                            <div class="feature-content">
                                <span class="feature-label">Bathrooms</span>
                                <span class="feature-value">{{ property.bathrooms|default:"N/A" }}</span>
                            </div>
                        </li>
                    </ul>
                </div>

                <!-- Agent Details -->
                <div class="info-card agent-card">
                    <h4 class="info-card-title">
                        <i class="fas fa-user-tie me-2"></i>
                        Seller Details
                    </h4>
                    <ul class="agent-list">
                        <li class="agent-item">
                            <span class="agent-label">Listed By</span>
                            <span class="agent-value">{{ property.owner|default:"N/A" }}</span>
                        </li>
                        <li class="agent-item">
                            <span class="agent-label">Phone Number</span>
                            <span class="agent-value">{{ property.phone_number|default:"N/A" }}</span>
                        </li>
                        <li class="agent-item">
                            <span class="agent-label">Negotiable</span>
                            <span class="agent-value">{{ property.get_negotiate_display|default:"N/A" }}</span>
                        </li>
                        <li class="agent-item">
                            <span class="agent-label">Last Updated</span>
                            <span class="agent-value">{{ property.last_updated|date:"M d, Y"|default:"N/A" }}</span>
                        </li>
                        <li class="agent-item">
                            <span class="agent-label">Listed On</span>
                            <span class="agent-value">{{ property.listed_date|date:"M d, Y"|default:"N/A" }}</span>
                        </li>
                    </ul>
                </div>
            </div>

            <!-- Contact Buttons -->
            <div class="contact-section">
                <h3 class="section-title text-center">
                    <i class="fas fa-phone me-2"></i>
                    Contact Seller
                </h3>
                <div class="contact-buttons">
                    <a href="tel:{{ property.phone_number|default:'' }}" class="btn-contact primary">
                        <i class="fas fa-phone-alt me-2"></i>
                        Call Seller
                    </a>
                    <a href="#" class="btn-contact secondary">
                        <i class="fas fa-user-circle me-2"></i>
                        View Seller Profile
                    </a>
                </div>
            </div>

            <!-- Map Section -->
            <div class="map-section">
                <h3 class="section-title">
                    <i class="fas fa-map-marker-alt me-2"></i>
                    Property Location
                </h3>
                <div class="map-placeholder">
                    <i class="fas fa-map-marked-alt"></i>
                    <p>Map integration coming soon!</p>
                    <img src="https://placehold.co/1000x400/e7f3ff/007bff?text=Map+Placeholder" 
                         alt="Map Placeholder" 
                         class="map-image">
                </div>
            </div>

        </div>

    </div>
</div>

{% endblock %}